<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SpellRightPro â€” Freemium OET</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- Firebase compat (NO defer) -->
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-analytics-compat.js"></script>

  <!-- Config (NO defer) -->
  <script src="/js/config.js?v=2025-08-29"></script>

  <!-- Initialize Firebase immediately (NO defer) -->
  <script>
    (function () {
      const cfg = window.appConfig && window.appConfig.firebaseConfig;
      if (!cfg) { console.error('firebaseConfig missing from config.js'); return; }
      if (!firebase.apps.length) {
        firebase.initializeApp(cfg);
        try { firebase.analytics(); } catch(_) {}
      }
    })();
  </script>

  <link rel="stylesheet" href="/css/styles.css">
  <link rel="icon" href="/assets/logo.png">
</head>
<body>
  <!-- your page markup ... -->
  <main id="app">
    <!-- OET UI -->
    <section id="summary-area" class="hidden"></section>
  </main>

  <!-- Inline ad injector (uses your client + slot) -->
  <script>
    (function injectSummaryAd() {
      const area = document.getElementById('summary-area');
      const client = (window.appConfig && window.appConfig.adClient) || 'ca-pub-7632930282249669';
      // Only inject when summary-area becomes visible
      const obs = new MutationObserver(() => {
        if (!area.classList.contains('hidden') && !area.dataset.adInjected) {
          const wrapper = document.createElement('div');
          wrapper.style.marginTop = '12px';
          wrapper.innerHTML =
            '<ins class="adsbygoogle" style="display:block" ' +
            'data-ad-client="'+client+'" data-ad-slot="YOUR_REAL_SLOT_ID" ' +
            'data-ad-format="auto" data-full-width-responsive="true"></ins>';
          area.appendChild(wrapper);
          try { (window.adsbygoogle = window.adsbygoogle || []).push({}); } catch(_){}
          area.dataset.adInjected = '1';
          obs.disconnect();
        }
      });
      obs.observe(area, { attributes:true, attributeFilter:['class'] });
    })();
  </script>

  <!-- Data must load BEFORE the app -->
  <script src="/js/oet_word_list.js?v=2025-08-29"></script>
  <!-- Helpers & App (defer ok here because DOM is parsed now) -->
  <script src="/js/common.js?v=2025-08-29"></script>
  <script src="/js/main-freemium-oet.js?v=2025-08-29"></script>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').catch(console.warn);
    }
  </script>
</body>
</html>
